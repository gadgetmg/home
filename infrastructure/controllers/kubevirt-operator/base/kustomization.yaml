# yaml-language-server: $schema=https://json.schemastore.org/kustomization
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
- https://github.com/kubevirt/kubevirt/releases/download/v1.4.0/kubevirt-operator.yaml
- https://github.com/kubevirt/containerized-data-importer/releases/download/v1.61.1/cdi-operator.yaml

patches:
# Premptively removes the v1alpha1 version of cdis.cdi.kubevirt.io as cdi-operator will remove it
# post-install and Argo CD will see it as out of sync.
# https://github.com/kubevirt/containerized-data-importer/pull/2527
- patch: |
    - op: remove
      path: /spec/versions/0
  target:
    kind: CustomResourceDefinition
    name: cdis.cdi.kubevirt.io
