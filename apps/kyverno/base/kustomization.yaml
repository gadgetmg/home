# yaml-language-server: $schema=https://json.schemastore.org/kustomization
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
- namespace.yaml
- clusterroles.yaml
- clusterrolebindings.yaml

components:
- ../../../shared/components/strip-helm-labels
- ../../../shared/components/kapp-noop-helm-hooks

helmCharts:
- name: kyverno
  repo: https://kyverno.github.io/kyverno/
  releaseName: kyverno
  namespace: kyverno
  version: 3.6.1
  apiVersions:
  - policy/v1/PodDisruptionBudget
  valuesInline:
    global:
      image:
        registry: ghcr.io
    admissionController:
      replicas: 1
      serviceMonitor:
        enabled: true
    backgroundController:
      replicas: 1
      serviceMonitor:
        enabled: true
    cleanupController:
      replicas: 1
      serviceMonitor:
        enabled: true
    reportsController:
      replicas: 1
      serviceMonitor:
        enabled: true

images:
- name: ghcr.io/kyverno/kyverno
  newTag: v1.16.2@sha256:b0c123d62a1b8e21da707450ef44c4616832434f919d1cd19cfdbe2836277699
- name: ghcr.io/kyverno/kyvernopre
  newTag: v1.16.1@sha256:e9b3a40f8da712abeb1d3896dac7af6d81a96284036d73a214e15d2c5e0f0e09
- name: ghcr.io/kyverno/background-controller
  newTag: v1.16.2@sha256:736c5da855863a3b15ee0e272f5b9e72c3c1b2f221f8345664354f57a5dc0f25
- name: ghcr.io/kyverno/cleanup-controller
  newTag: v1.16.2@sha256:1bf6d0501d7f16aa5d36821f907287d8653564c642866c4b597f2e6abc527390
- name: ghcr.io/kyverno/reports-controller
  newTag: v1.16.1@sha256:84291952cc15b3968c29a8a91370d6e8a4b9749136427c1f1be6a03f42703c6a
- name: ghcr.io/kyverno/kyverno-cli
  newTag: v1.16.1@sha256:4a34a24a85935fb4c9440f1831568a847ffb96296da2b5fd1ec3b76215a76621
