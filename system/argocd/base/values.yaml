configs:
  cm:
    resource.exclusions: |
      - apiGroups:
        - cilium.io
        kinds:
        - CiliumIdentity
        clusters:
        - "*"
    kustomize.buildOptions: --enable-alpha-plugins --enable-exec --enable-helm --load-restrictor LoadRestrictionsNone
dex:
  enabled: false
server:
  extraArgs:
  - --insecure
repoServer:
  volumes:
  - name: custom-tools
    emptyDir: {}
  - name: sops-age
    secret:
      secretName: argocd-sops-age
  initContainers:
  - name: install-ksops
    image: viaductoss/ksops:v4.3.1
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
        - ALL
      runAsUser: 999
      runAsNonRoot: true
      seccompProfile:
        type: RuntimeDefault
    command: ["/bin/sh", "-c"]
    args:
    - echo "Installing KSOPS...";
      mv ksops /custom-tools/;
      mv kustomize /custom-tools/;
      echo "Done.";
    volumeMounts:
    - mountPath: /custom-tools
      name: custom-tools
  volumeMounts:
  - mountPath: /usr/local/bin/kustomize
    name: custom-tools
    subPath: kustomize
  - mountPath: /usr/local/bin/ksops
    name: custom-tools
    subPath: ksops
  - mountPath: /home/argocd/.config/sops/age
    name: sops-age
    readOnly: true
