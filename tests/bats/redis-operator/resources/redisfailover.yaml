# yaml-language-server: $schema=../../../..//schemas/databases.spotahome.com/redisfailover_v1.json
apiVersion: databases.spotahome.com/v1
kind: RedisFailover
metadata:
  name: test-redis
spec:
  auth:
    secretPath: redis-auth
  redis:
    replicas: 3
    affinity:
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution: []
    image: valkey/valkey:alpine
    exporter:
      enabled: true
      image: docker.io/oliver006/redis_exporter:alpine
    securityContext:
      runAsNonRoot: true
      runAsUser: 1000
      seccompProfile:
        type: RuntimeDefault
    containerSecurityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop: [ALL]
    storage:
      emptyDir: {}
  sentinel:
    replicas: 3
    affinity:
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution: []
    image: valkey/valkey:alpine
    exporter:
      enabled: true
      image: docker.iooliver006/redis_exporter:alpine
    securityContext:
      runAsNonRoot: true
      runAsUser: 1000
      seccompProfile:
        type: RuntimeDefault
    containerSecurityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop: [ALL]
